# AI Self-Optimizing Trading System (AISOTS)

ä½¿ç”¨ Shioaji API çš„ AI é©…å‹•æœŸè²¨äº¤æ˜“ç³»çµ±ï¼Œæ”¯æ´ LLM ç­–ç•¥ç”Ÿæˆèˆ‡è‡ªæˆ‘å„ªåŒ–ã€‚

## åŠŸèƒ½ç‰¹è‰²

- ğŸ¤– **AI ç­–ç•¥ç”Ÿæˆ** - ç”¨è‡ªç„¶èªè¨€æè¿°ç­–ç•¥ï¼ŒLLM è‡ªå‹•ç”Ÿæˆç¨‹å¼ç¢¼
- ğŸ¯ **ç›®æ¨™é©…å‹•ç­–ç•¥** - åªéœ€çµ¦å‡ºç›®æ¨™ï¼ˆå¦‚ã€Œæ¯æ—¥è³º500å…ƒã€ï¼‰ï¼ŒLLM è‡ªå‹•æ¨æ–·åƒæ•¸ä¸¦ç¢ºèªå¾Œå»ºç«‹
- ğŸ”’ **ç­–ç•¥é©—è­‰** - å»ºç«‹ç­–ç•¥æ™‚è‡ªå‹•åŸ·è¡Œå…©éšæ®µé©—è­‰ï¼ˆLLMå¯©æŸ¥æ¯”å°ç¨‹å¼ç¢¼æ˜¯å¦ç¬¦åˆç­–ç•¥æè¿° + æ­·å²Kæ£’å›æ¸¬ï¼‰
- ğŸ“Š **æ­·å²å›æ¸¬** - åŸ·è¡Œå®Œæ•´æ­·å²å›æ¸¬ï¼Œå•Ÿç”¨ç­–ç•¥å‰åƒè€ƒéå»ç¸¾æ•ˆï¼ˆå«åœ–è¡¨ï¼‰
- ğŸ“ˆ **è‡ªæˆ‘å„ªåŒ–ç³»çµ±** - è¨­å®šç›®æ¨™ â†’ LLM è¨­è¨ˆç­–ç•¥ â†’ åŸ·è¡Œ â†’ ç¸¾æ•ˆåˆ†æ â†’ LLM å¯©æŸ¥å„ªåŒ– â†’ é”æˆç›®æ¨™
- ğŸ”” **Telegram é€šçŸ¥** - äº¤æ˜“æé†’ã€é£æ§è­¦å‘Šå³æ—¶æ¨é€ï¼ˆä»…é€šçŸ¥ï¼Œä¸æ¥å—å‘½ä»¤ï¼‰
- ğŸŒ **Web ç•Œé¢** - **ä¸»è¦æ“ä½œå¹³å°**ï¼Œå›¾å½¢åŒ–ç®¡ç†ç­–ç•¥ã€éƒ¨ä½ã€å›æµ‹ï¼Œæ— éœ€è®°å¿†æŒ‡ä»¤
- ğŸ“Š **å¤šç¨® LLM æ”¯æ´** - Ollama, OpenAI, Anthropic, OpenRouter
- ğŸ›¡ï¸ **é¢¨æ§æ©Ÿåˆ¶** - å–®æ—¥è™§æã€æœ€å¤§éƒ¨ä½ã€ä¸‹å–®é »ç‡é™åˆ¶
- ğŸ’¾ **è³‡æ–™æŒä¹…åŒ–** - JSON æ ¼å¼å„²å­˜ç­–ç•¥ã€éƒ¨ä½ã€è¨‚å–®ã€è¨Šè™Ÿ

## å®‰è£

```bash
git clone https://github.com/kaiching0108/AISOTS.git
cd AISOTS
pip install -r requirements.txt
```

## Telegram for Notify 
- Create a bot
  - Open Telegram, search @BotFather
  - Send /newbot, follow prompts
  - Copy the token

## Configè¨­å®š 

ç·¨è¼¯ `config.yaml`ï¼š

```yaml
shioaji:
  api_key: "YOUR_API_KEY"
  secret_key: "YOUR_SECRET_KEY"
  simulation: true  # æ¸¬è©¦æ¨¡å¼

llm:
  provider: "custom"
  base_url: "http://localhost:11434/v1"
  model: "llama3"

telegram:
  bot_token: "YOUR_BOT_TOKEN"
  chat_id: "YOUR_CHAT_ID"

# é¢¨æ§é…ç½®
risk:
  max_daily_loss: 10000          # å–®æ—¥æœ€å¤§è™§æ (å…ƒ)
  max_position: 3               # æœ€å¤§å£æ•¸ç¸½å’Œ
  max_orders_per_minute: 1       # æ¯åˆ†é˜æœ€å¤§ä¸‹å–®æ•¸
  enable_stop_loss: true         # å•Ÿç”¨åœæ
  enable_take_profit: true       # å•Ÿç”¨æ­¢ç›ˆ

# äº¤æ˜“é…ç½®
trading:
  check_interval: 60             # æª¢æŸ¥é–“éš” (ç§’)
  trading_hours:
    day_start: "08:45"
    day_end: "13:45"
    night_start: "15:00"
    night_end: "05:00"

# Web ç•Œé¢é…ç½®ï¼ˆä¸»è¦æ“ä½œç•Œé¢ï¼‰
web:
  enabled: true          # å•Ÿç”¨ Web ç•Œé¢ï¼ˆä¸»è¦æ“ä½œå¹³å°ï¼‰
  host: "127.0.0.1"     # ç¶å®šä½å€ï¼ˆæœ¬æ©Ÿï¼‰
  port: 5001            # é€£æ¥åŸ 
```

## ä½¿ç”¨æ–¹å¼

```bash
# ä¸€èˆ¬å•Ÿå‹•ï¼ˆéœ€è¦ Shioaji ç™»å…¥ï¼‰
python main.py

# æ¨¡æ“¬æ¨¡å¼ï¼ˆè·³é API ç™»å…¥ï¼Œç”¨æ–¼æ¸¬è©¦ï¼‰
python main.py --simulate
```

### é€é Web ç•Œé¢å»ºç«‹ç­–ç•¥

è¨ªå• `http://127.0.0.1:5001/strategies/create`ï¼Œå¡«å¯«è¡¨å–®ï¼š

1. æç¤ºè©è¼¸å…¥ç­–ç•¥ï¼Œé¸æ“‡æœŸè²¨ä»£ç¢¼ï¼ˆTXF/MXF/TMFï¼‰
2. äº¤æ˜“æ–¹å‘ï¼ˆåšå¤š/åšç©º/å¤šç©ºéƒ½åšï¼‰
3. ç­–ç•¥æè¿°ï¼ˆå¦‚ã€ŒRSI ä½æ–¼ 30 è²·å…¥ï¼Œé«˜æ–¼ 70 è³£å‡ºã€ï¼‰
4. Kç·šé€±æœŸï¼ˆ1m/5m/15m/30m/60m/1h/1dï¼‰
5. åœæé»æ•¸ã€æ­¢ç›ˆé»æ•¸ã€äº¤æ˜“å£æ•¸
6. é»æ“Š Generate ç”±AIç”Ÿæˆç­–ç•¥æè¿°é è¦½
7. ç¢ºèªåƒæ•¸å¾Œé»æ“Šã€Œç¢ºèªå»ºç«‹ã€

ç³»çµ±æœƒè‡ªå‹•åŸ·è¡Œå…©éšæ®µé©—è­‰ï¼š
- Stage 1ï¼šLLM è‡ªæˆ‘å¯©æŸ¥ï¼ˆæª¢æŸ¥ç¨‹å¼ç¢¼æ˜¯å¦ç¬¦åˆç­–ç•¥æè¿°ï¼‰
- Stage 2ï¼šæ­·å²å›æ¸¬ï¼ˆæª¢æŸ¥è¨Šè™Ÿåˆ†ä½ˆæ˜¯å¦åˆç†ï¼‰

é©—è­‰é€šéå¾Œï¼Œç­–ç•¥å»ºç«‹æˆåŠŸã€‚

### Telegram é€šçŸ¥

Telegram æ©Ÿå™¨äºº **åƒ…ç”¨æ–¼æ¥æ”¶é€šçŸ¥**ã€‚

é€šçŸ¥é¡å‹ï¼š
- ç³»çµ±å•Ÿå‹•/åœæ­¢
- æˆäº¤é€šçŸ¥
- åœæ/æ­¢ç›ˆè§¸ç™¼
- é¢¨æ§è­¦å‘Š
- ç³»çµ±éŒ¯èª¤

## è‡ªæˆ‘å„ªåŒ–ç³»çµ±

### ç³»çµ±é¡˜æ™¯

```
ç”¨æˆ¶è¼¸å…¥ç›®æ¨™ â†’ LLM è¨­è¨ˆç­–ç•¥ â†’ åŸ·è¡Œ â†’ ç¸¾æ•ˆåˆ†æ â†’ LLM å¯©æŸ¥å„ªåŒ– â†’ é”æˆç›®æ¨™
```

### ç›®æ¨™è¨­å®š

æ¯å€‹ç­–ç•¥å¯ä»¥è¨­å®šæ˜ç¢ºçš„æ•¸å€¼ç›®æ¨™ï¼š

| æ¬„ä½ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| goal | ç›®æ¨™æ•¸å€¼ï¼ˆå¿…é ˆç‚ºæ•¸å­—ï¼‰| 500 |
| goal_unit | ç›®æ¨™å–®ä½ | daily/weekly/monthly/quarterly/yearly |

### å®Œæ•´å„ªåŒ–æµç¨‹

```
1. ç”¨æˆ¶è¼¸å…¥ç›®æ¨™ï¼ˆå¦‚ã€Œæ¯æ—¥è³º500å…ƒã€ï¼‰
2. LLM è¨­è¨ˆç­–ç•¥ â†’ ç”¨æˆ¶ç¢ºèª
3. ç­–ç•¥åŸ·è¡Œ â†’ è¨˜éŒ„è¨Šè™Ÿ â†’ æ›´æ–°çµæœ
4. ç¸¾æ•ˆåˆ†æ â†’ æª¢æŸ¥ç›®æ¨™æ˜¯å¦é”æˆ
   â”œâ”€â”€ å·²é”æˆ â†’ ç¶­æŒç¾ç‹€
   â””â”€â”€ æœªé”æˆ â†’ LLM å¯©æŸ¥ â†’ å»ºè­°ä¿®æ”¹
5. ç”¨æˆ¶ç¢ºèªä¿®æ”¹ â†’ æ›´æ–°ç­–ç•¥
6. ç¹¼çºŒåŸ·è¡Œ â†’ å¾ªç’°ç›´åˆ°é”æˆç›®æ¨™
```

### LLM å»ºè­°é¡å‹

LLM å¯©æŸ¥å¾Œå¯èƒ½çµ¦å‡ºä»¥ä¸‹å»ºè­°ï¼š

| é¡å‹ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| åƒæ•¸èª¿æ•´ | ä¿®æ”¹åœæã€æ­¢ç›ˆã€æ•¸é‡ç­‰ | ã€Œåœæå¤ªè¿‘ï¼Œå»ºè­°å¾ 30 é»æ”¹ç‚º 50 é»ã€ |
| Prompt å¾®èª¿ | ä¿®æ”¹äº¤æ˜“é‚è¼¯æè¿° | ã€Œå»ºè­°åŠ å…¥ MACD ç¢ºèªè¨Šè™Ÿã€ |
| é‡æ–°è¨­è¨ˆ | å®Œå…¨é‡æ–°è¨­è¨ˆç­–ç•¥ | ã€Œ RSI ç­–ç•¥ä¸é©åˆç•¶å‰å¸‚å ´ã€ |

### è‡ªå‹• LLM Review æ”¯æ´è‡ªå‹•å®šæ™‚è§¸ç™¼æ’ç¨‹

ç³»çµ± LLM å¯©æŸ¥ï¼Œç„¡éœ€æ‰‹å‹•è¼¸å…¥å‘½ä»¤ï¼š

```yaml
auto_review:
  enabled: true
  schedules:
    - strategy_id: "TMF260001"
      period: 5
      unit: "day"      # æ¯ 5 å¤©è§¸ç™¼ä¸€æ¬¡
    - strategy_id: "TXF260001"
      period: 2
      unit: "week"     # æ¯ 2 é€±è§¸ç™¼ä¸€æ¬¡
```

**è¦å‰‡**ï¼š
- æ¯å¤©æ¯ç­–ç•¥æœ€å¤šè§¸ç™¼ 1 æ¬¡
- æ‰‹å‹• `review` å‘½ä»¤ä¸å—é™åˆ¶
- ç„¡ goal ç­–ç•¥æœƒè·³é

## å°ˆæ¡ˆçµæ§‹

```
AISOTS/
â”œâ”€â”€ main.py                 # å…¥å£ç¨‹å¼
â”œâ”€â”€ config.yaml            # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt       # Python ä¾è³´
â”œâ”€â”€ AGENTS.md             # Agent é–‹ç™¼æŒ‡å—
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/              # Shioaji API åŒ…è£
â”‚   â”‚   â”œâ”€â”€ shioaji_client.py
â”‚   â”‚   â”œâ”€â”€ connection.py
â”‚   â”‚   â””â”€â”€ order_callback.py
â”‚   â”‚
â”‚   â”œâ”€â”€ trading/          # äº¤æ˜“é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ strategy.py
â”‚   â”‚   â”œâ”€â”€ strategy_manager.py
â”‚   â”‚   â”œâ”€â”€ position.py
â”‚   â”‚   â”œâ”€â”€ position_manager.py
â”‚   â”‚   â”œâ”€â”€ order.py
â”‚   â”‚   â””â”€â”€ order_manager.py
â”‚   â”‚
â”‚   â”œâ”€â”€ engine/           # ç­–ç•¥å¼•æ“
â”‚   â”‚   â”œâ”€â”€ framework.py       # ç­–ç•¥æ¡†æ¶
â”‚   â”‚   â”œâ”€â”€ llm_generator.py  # LLM ç­–ç•¥ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ runner.py         # ç­–ç•¥åŸ·è¡Œå™¨
â”‚   â”‚   â”œâ”€â”€ backtest_engine.py # backtesting.py å›æ¸¬å¼•æ“
â”‚   â”‚   â”œâ”€â”€ rule_engine.py   # è¦å‰‡å¼•æ“
â”‚   â”‚   â””â”€â”€ rule_parser.py   # è¦å‰‡è§£æå™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ agent/            # AI Agent
â”‚   â”‚   â”œâ”€â”€ tools.py          # äº¤æ˜“å·¥å…·
â”‚   â”‚   â”œâ”€â”€ prompts.py       # æç¤ºè©
â”‚   â”‚   â””â”€â”€ providers.py     # LLM æä¾›è€…
â”‚   â”‚
â”‚   â”œâ”€â”€ market/           # å¸‚å ´æ•¸æ“š
â”‚   â”‚   â”œâ”€â”€ data_service.py
â”‚   â”‚   â””â”€â”€ price_cache.py
â”‚   â”‚
â”‚   â”œâ”€â”€ storage/          # è³‡æ–™å„²å­˜
â”‚   â”‚   â”œâ”€â”€ json_store.py
â”‚   â”‚   â””â”€â”€ models.py
â”‚   â”‚
â”‚   â”œâ”€â”€ risk/            # é¢¨æ§ç®¡ç†
â”‚   â”‚   â””â”€â”€ risk_manager.py
â”‚   â”‚
â”‚   â”œâ”€â”€ notify/          # é€šçŸ¥ç³»çµ±
â”‚   â”‚   â””â”€â”€ telegram.py  # Telegram é€šçŸ¥ + Bot
â”‚   â”‚
â”‚   â”œâ”€â”€ web/            # Web ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ app.py          # Flask æ‡‰ç”¨
â”‚   â”‚   â””â”€â”€ routes/         # API è·¯ç”±
â”‚   â”‚       â”œâ”€â”€ status.py
â”‚   â”‚       â”œâ”€â”€ strategies.py
â”‚   â”‚       â”œâ”€â”€ positions.py
â”‚   â”‚       â”œâ”€â”€ risk.py
â”‚   â”‚       â””â”€â”€ backtest.py
â”‚   â”‚
â”‚   â”œâ”€â”€ analysis/        # ç¸¾æ•ˆåˆ†ææ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ signal_recorder.py       # è¨Šè™Ÿè¨˜éŒ„å™¨
â”‚   â”‚   â”œâ”€â”€ performance_analyzer.py  # ç¸¾æ•ˆåˆ†æå™¨
â”‚   â”‚   â”œâ”€â”€ strategy_reviewer.py     # LLM ç­–ç•¥å¯©æŸ¥
â”‚   â”‚   â””â”€â”€ auto_review_scheduler.py # è‡ªå‹• Review æ’ç¨‹
â”‚   â”‚
â”‚   â””â”€â”€ config.py        # é…ç½®è¼‰å…¥
â”‚
â”œâ”€â”€ documents/           # èªªæ˜æ–‡ä»¶
â”‚   â”œâ”€â”€ Features.md
â”‚   â”œâ”€â”€ System_Architecture.md
â”‚   â”œâ”€â”€ User_Manual.md
â”‚   â””â”€â”€ Web_Interface.md
â”‚
â”œâ”€â”€ tests/               # æ¸¬è©¦æª”æ¡ˆ
â”‚   â”œâ”€â”€ test_trading.py
â”‚   â”œâ”€â”€ test_fallback.py
â”‚   â”œâ”€â”€ test_create_flow.py
â”‚   â””â”€â”€ conftest.py
â”‚
â””â”€â”€ workspace/          # åŸ·è¡Œæ™‚è³‡æ–™
    â”œâ”€â”€ strategies/       # ç­–ç•¥é…ç½®ï¼ˆå«ç‰ˆæœ¬ï¼‰
    â”‚   â””â”€â”€ TMF260001_v1.json
    â”œâ”€â”€ positions/        # éƒ¨ä½è¨˜éŒ„
    â”‚   â””â”€â”€ TMF260001_positions.json
    â”œâ”€â”€ orders/           # è¨‚å–®è¨˜éŒ„
    â”‚   â””â”€â”€ TMF260001_orders.json
    â”œâ”€â”€ signals/         # è¨Šè™Ÿè¨˜éŒ„ï¼ˆå«ç‰ˆæœ¬ï¼‰
    â”‚   â””â”€â”€ TMF260001_v1.json
    â”œâ”€â”€ backtests/       # å›æ¸¬åœ–è¡¨
    â”‚   â””â”€â”€ TMF260001.png
    â”œâ”€â”€ performance.json # ç¸¾æ•ˆæ•¸æ“š
    â””â”€â”€ logs/
        â””â”€â”€ trading.log
```

## æŠ€è¡“

- Python 3.10+
- Shioaji API
- pandas_ta
- backtesting.py
- python-telegram-bot
- LLM (Ollama/OpenAI/Anthropic)

## ç‰ˆæœ¬è³‡è¨Š

| ç‰ˆæœ¬ | èªªæ˜ |
|------|------|
| 1.0.0 | åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æ´3å€‹ç­–ç•¥ |
| 2.0.0 | æ–°å¢ LLM ç­–ç•¥ç”Ÿæˆå™¨èˆ‡ç­–ç•¥æ¡†æ¶ |
| 2.1.0 | æ–°å¢ Telegram Bot æ¥æ”¶æ©Ÿåˆ¶ |
| 3.0.0 | æ–°å¢è‡ªæˆ‘å„ªåŒ–ç³»çµ± - ç¬¬ä¸€éšæ®µ |
| 3.1.0 | æ–°å¢è‡ªæˆ‘å„ªåŒ–ç³»çµ± - ç¬¬äºŒéšæ®µ |
| 3.2.0 | æ–°å¢è‡ªæˆ‘å„ªåŒ–ç³»çµ± - ç¬¬ä¸‰éšæ®µ |
| 3.3.0 | æ–°å¢ç­–ç•¥ç¨‹å¼ç¢¼å…©éšæ®µé©—è­‰ï¼ˆLLMå¯©æŸ¥+æ­·å²Kæ£’å›æ¸¬ï¼‰|
| 3.4.0 | æ–°å¢ BacktestEngine å®Œæ•´æ­·å²å›æ¸¬ç³»çµ± |
| 3.5.0 | æ–°å¢ Web ç•Œé¢ã€åˆªé™¤ç­–ç•¥äºŒæ¬¡ç¢ºèªã€å›æ¸¬åœ–è¡¨åŒ¯å‡º |

## License

MIT
